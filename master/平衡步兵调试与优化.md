# 平衡步兵调试与优化



## 调试

- theta给太大可能会因为输出力矩太大而被限制导致效果倾角拉回去反而不好
- 当动量块发抖时增大动量块力矩的r阵的权重





## 功能

### 自动退出BLOCK	

> 针对场上平衡步兵可能在上电重启后在墙角卡住的情况，加入了自动退出卡住状态的代码。判断条件是轮子的扭矩大于一定值，轮子速度小于一定值且倾角大于一定值(针对倒下的情况)，以上情况在持续一段时间后进入卡住状态，车体会向后运动一小段距离以退出可能卡住的区域，之后再尝试重新起立。



### 飞坡后倾

> 如果以直立状态飞坡可能会因为速度不够而失败，因此在飞坡前先后倾倒地，在加速后冲上坡道，直到离开坡后切回原来的状态



### 自动BURST

> 平衡步兵的平常功率较低，但是在加速/减速，倒地直立等情况下对功率要求较高。因此在状态切换时需要进burst来提高功率(大概150w)

相应功能可以在Input_Event中新增延时事件，当事件被触发后先执行一个回调函数，一定时间后再执行下一个回调函数。例如按下前进键后先执行进爆发的回调，一段时间后再执行回到normal的回调函数





